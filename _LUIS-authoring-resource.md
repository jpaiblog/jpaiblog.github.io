---
title: LUIS オーサリング リソースへの移行について
date: 2020-06-05 00:00:00
categories:
- Cognitive Services
tags:
- LUIS
---
LUIS オーサリング リソースへの移行について、オーサリング リソースの役割および移行による変更点を紹介します。
<!-- more -->
<br>

***
現在 LUIS では Azure オーサリング リソースへの移行を進めており、[LUIS ポータル](https://www.luis.ai) 上での通知に加えて、対象ユーザーには個別で移行に関するご案内をしています。この記事では LUIS オーサリング リソースがどのような役割を持っているのか、また、移行を行うことによる変更点を紹介します。

### ■LUIS オーサリング リソースの役割

これまで LUIS は、利用開始に Azure サブスクリプションを必要としないサービスとして提供されてきました。Azure サブスクリプションをお持ちでなくても、LUIS のアプリケーションを作成することはできますが、実際にアプリケーションを Bot などから利用する場合には、 Azure の LUIS ランタイム (Prediciton) リソースをアプリケーションに紐づけて使用しています。

この場合、LUIS のアプリケーションは LUIS ポータルにサインインした、各ユーザーのアカウント (メールアドレス) に関連付けられています。一方で、ユーザーのメールアドレスに紐づけて管理していることにより、以下のような問題がありました。

- LUIS アプリケーションの所有権を他のユーザーに移転できない
- Azure とは独立したシステムでアクセス権を制御するため統一的な管理が困難

これらの問題を解決するため、LUIS のアプリケーション管理を Azure に統合する方針となり、LUIS オーサリング リソースが導入されました。

オーサリング リソースを使用しない場合と、オーサリング リソースを使用した場合の、アプリケーションの関連付けや共有方法の違いを図にまとめると以下のようになります。

![LUIS-migration](https://jpaiblog.github.io/images/LUIS-authoring-resource/LUIS-migration.png)

他のユーザーが所有するアプリケーションにアクセスするには、移行前はコラボレーターと呼ばれる機能により、メールアドレス ベースで、アプリごとに設定する必要がありました。

一方で移行すると、 LUIS アプリケーションは LUIS オーサリング リソースに関連付けられ、そのリソースに対するアクセス権を Azure の標準的なロールベースのアクセス制御 (RBAC) で管理できるようになります。

### ■ランタイム リソースとオーサリング リソースの関係

オーサリング リソースは LUIS アプリケーションを作成・編集するためだけに使用されます。予測エンドポイント API の使用には、引き続き LUIS アプリケーションに関連付けた、ランタイム (Prediciton) リソース、もしくは試用版の API キー (スターター キー) が必要です。この 2 種類のリソースの違いを図にすると以下のようになります。

![LUIS-auth-endpoint-diff](https://jpaiblog.github.io/images/LUIS-authoring-resource/LUIS-auth-endpoint-diff.png)

ここで、オーサリング リソースを作成するリージョンと、ランタイム リソースを作成するリージョンは、顧客データの取り扱いに特別なルールがある地域 (オーストラリア、ヨーロッパ) を除き、異なるリージョンになっていても構いません。

2020 年 6 月 5 日現在、上記 2 つの地域以外のリージョンで LUIS アプリケーションを公開する場合は、オーサリング リソースのリージョンは米国西部のみとなります。公開を行うと、アプリケーションに関連付けられたランタイム リソースのリージョン (図の例では東日本リージョン) に自動で展開されます。

### ■関連する公開ドキュメント

- [Azure リソース オーサリング キーに移行する](https://docs.microsoft.com/ja-jp/azure/cognitive-services/luis/luis-migration-authoring)
- [Azure オーサリング リソースに移行するための手順](https://docs.microsoft.com/ja-jp/azure/cognitive-services/luis/luis-migration-authoring-steps)
- [オーサリング キーとランタイム キー](https://docs.microsoft.com/ja-jp/azure/cognitive-services/luis/luis-concept-keys)
- [作成と公開のリージョンと関連付けられているキー](https://docs.microsoft.com/ja-jp/azure/cognitive-services/luis/luis-reference-regions#publishing-regions)


### ■FAQ

#### Q. オーサリング リソースに移行しないとどうなる？
A. 2020 年 6 月 5 日現在、オーサリング リソースの移行期限は 2020 年 9 月 30 日となっております。2020 年 10 月 1 日時点で移行されていないアプリケーションはアクセスできなくなる可能性があります。

#### Q. オーサリングリソースの移行単位は？
A. オーサリング リソースへの移行は、 LUIS ポータルにサインインするユーザーアカウント単位です。移行作業では、自身が所有している LUIS アプリケーションを、どのオーサリング リソースに関連付けるかを指定します。組織単位でまとめて実施するような方法はありません。

#### Q. オーサリング リソースへの移行でダウンタイムが発生する？
A. オーサリング リソースに移行しても、LUIS アプリケーションとランタイム リソースの紐づけはそのまま維持されます。移行作業中もエンドポイント API の呼び出しについてダウンタイムは通常発生しません。

#### Q. オーサリング リソースに移行したら他のユーザーからアプリケーションが見えなくなった
A. 移行前のコラボレーターの設定は自動では移行されませんので、移行後に RBAC で適切な権限の再設定が必要です。また RBAC の設定が適切でも、移行していないユーザーは、移行後のアプリケーションを LUIS ポータルで確認することはできません。

#### Q. LUIS の新規ユーザーはどうなる？
A. 2020 年 6 月 5 日現在は LUIS の使用開始時に、アプリケーションの紐づけ先となる LUIS オーサリング リソースを指定するか、オーサリング リソースを利用せず試用版 (スターター キー) を使用するか選択できます。ここでオーサリング リソースを選択しなかった場合は期限までに移行が必要です。

#### Q. LUIS のアプリケーション単位で他のユーザーと共有したい
A. 移行後はオーサリング リソースにアプリケーションが関連付けられます。アクセス権を付与できるのはオーサリング リソース単位で、アプリケーション単位では付与できません。新しいオーサリング リソースを作成して、共有したいアプリケーションのみをインポートすることで、特定のアプリケーションを共有できます。

***
`変更履歴`    
`2020/06/05 created by Nakagami`  